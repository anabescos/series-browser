"use strict";const inputElement=document.querySelector(".js-input"),buttonElement=document.querySelector(".js-button"),formElement=document.querySelector(".js-form"),ulSeriesList=document.querySelector(".js-seriesList"),favListElement=document.querySelector(".js-favList"),resetElement=document.querySelector(".js-reset");let seriesList=[],favouriteSeries=[];function getDataFromApi(){getFromLocalStorage();const e=inputElement.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{seriesList=[];for(let t=0;t<e.length;t++){const s=e[t].show;seriesList.push(s)}renderSeries()})}function handleForm(e){e.preventDefault()}function renderSeries(){let e="";for(const t of seriesList){let s;isFavSeries(t)?(s="favourite",console.log("found a favourite")):(s="",console.log("found a not favourite")),e+=`<li class='js-series ${s}' id="${t.id}">`,e+=`<h2 class='js-seriesTitle''>${t.name}</h2>`;const i=t.image;e+=null===i?'<img class="sectionSeries__list--img" src="./assets/images/default.png">':`<img class="sectionSeries__list--img" src=${i.medium}>`,e+="</li>"}ulSeriesList.innerHTML=e,listenToCardsEvent()}function isFavSeries(e){return void 0!==favouriteSeries.find(t=>t.id===e.id)||(console.log(e.id),!1)}function listenToCardsEvent(){const e=document.querySelectorAll(".js-series");for(const t of e)t.addEventListener("click",handleCard)}function handleCard(e){const t=parseInt(e.currentTarget.id),s=seriesList.find(e=>e.id===t),i=favouriteSeries.findIndex(e=>e.id===t);-1===i?favouriteSeries.push(s):favouriteSeries.splice(i,1),setInLocalStorage(),renderFavourites(),renderSeries()}function renderFavourites(){let e="";for(const t of favouriteSeries){e+=`<li class='js-fav'id="${t.id}">`,e+=`<h2 class='js-favTitle''>${t.name}</h2>`;const s=t.image;e+=null===s?'<img class="sectionFav__list--img" src="./assets/images/default.png">':`<img class="sectionFav__list--img" src=${s.medium}>`,e+="</li>",e+=`<button class="js-remove" id ="${t.id}">X</button>`}favListElement.innerHTML=e,listenToRemoveButtons()}function listenToRemoveButtons(){const e=document.querySelectorAll(".js-remove");for(const t of e)t.addEventListener("click",handleRemove)}function handleRemove(e){console.log(favouriteSeries);const t=parseInt(e.currentTarget.id),s=favouriteSeries.findIndex(e=>e.id===t);-1!==s&&favouriteSeries.splice(s,1),console.log(t),console.log(favouriteSeries),renderFavourites(),setInLocalStorage(),renderSeries()}function setInLocalStorage(){const e=JSON.stringify(favouriteSeries);localStorage.setItem("favouriteSeries",e)}function getFromLocalStorage(){const e=localStorage.getItem("favouriteSeries");if(null!==e){const t=JSON.parse(e);favouriteSeries=t,renderFavourites()}}function resetButton(){localStorage.clear("favouriteSeries"),favouriteSeries=[],renderFavourites()}buttonElement.addEventListener("click",getDataFromApi),formElement.addEventListener("submit",handleForm),resetElement.addEventListener("click",resetButton),getFromLocalStorage();